#include "common_main.h"
#include "kosaraju.h"  // defined in generated

class my_main: public main_t
{
public:
    int* membership;
    int  num_membership;

    virtual ~my_main() {
        delete[] membership;
    }

    my_main() : membership(NULL), num_membership(0) {
    }

    virtual bool prepare() {
        membership = new int[G.num_nodes()];
        num_membership = 0;
        return true;
    }

    virtual bool run() 
    {
        num_membership = kosaraju(G, membership);
        return true;
    }

    virtual bool post_process() {
        printf("num_membership = %d\n", num_membership);
        return true;
    }
};

#define TEST_LARGE  0

int main(int argc, char** argv)
{
#if TEST_LARGE
    my_main M;
    M.main(argc, argv);
#else

   gm_graph G;
//   for(int i=0;i<10;i++)
//        G.add_node();

//    G.add_edge(0,1);
//    G.add_edge(1,2);
//    G.add_edge(2,3);
//    G.add_edge(3,0);
//    G.add_edge(5,8);
//    G.add_edge(7,4);
//    G.add_edge(9,1);
//    G.add_edge(1,4);
//    G.add_edge(2,5);
//    G.add_edge(4,9);
for(int i=0;i<=999;i++){
        G.add_node();
    }
int edges[][2] = {{893,942},{29,205},{297,520},{173,639},{600,639},{406,760},{657,964},{222,955},{92,710},{505,841},{185,632},{265,713},{105,896},{364,402},{176,376},{301,547},{640,697},{104,737},{938,952},{350,645},{470,988},{507,598},{195,514},{187,410},{235,403},{562,777},{211,839},{695,879},{56,762},{104,898},{105,955},{163,617},{156,949},{306,579},{31,161},{691,826},{58,912},{512,970},{463,985},{377,724},{91,439},{819,909},{184,222},{457,697},{18,652},{357,364},{291,677},{93,774},{577,996},{683,748},{74,821},{202,276},{82,99},{243,883},{547,897},{576,761},{60,820},{395,820},{12,732},{151,261},{190,427},{287,890},{454,907},{86,615},{377,858},{581,840},{556,929},{524,875},{157,551},{327,512},{45,479},{273,443},{179,416},{361,739},{81,418},{637,729},{724,792},{329,491},{190,851},{496,796},{358,924},{327,680},{290,559},{364,630},{201,336},{344,430},{780,835},{720,931},{39,441},{63,973},{768,953},{567,910},{107,986},{625,788},{233,910},{11,254},{84,275},{100,638},{381,388},{227,558},{460,696},{351,445},{920,979},{2,708},{584,850},{329,829},{922,977},{504,810},{245,826},{410,960},{684,839},{341,689},{651,838},{72,654},{46,89},{228,503},{734,975},{333,912},{603,948},{705,852},{12,311},{693,739},{316,585},{66,420},{431,919},{33,821},{735,984},{1,22},{412,556},{249,991},{65,965},{678,800},{19,796},{479,949},{844,916},{16,557},{290,966},{97,921},{395,917},{222,407},{398,660},{794,825},{274,370},{562,734},{246,868},{741,859},{501,893},{409,520},{58,252},{758,976},{372,574},{626,723},{79,804},{114,852},{280,351},{779,836},{178,473},{451,580},{679,984},{700,715},{362,906},{501,618},{582,886},{357,555},{97,534},{320,598},{54,266},{274,433},{662,669},{508,568},{310,336},{354,382},{170,886},{849,951},{640,845},{452,474},{593,847},{201,410},{593,990},{42,230},{21,505},{8,261},{119,221},{727,993},{636,816},{559,788},{1,570},{849,881},{140,828},{27,486},{132,561},{346,561},{65,999},{440,755},{148,819},{278,626},{106,917},{153,667},{647,755},{845,977},{545,602},{54,900},{148,306},{29,102},{5,398},{27,826},{478,485},{454,887},{127,454},{450,960},{465,951},{52,629},{302,995},{84,351},{272,616},{464,592},{25,336},{275,351},{397,930},{67,491},{416,602},{208,443},{63,948},{214,264},{413,859},{73,141},{653,687},{177,959},{33,586},{244,355},{661,728},{315,899},{199,277},{193,285},{128,178},{150,236},{33,846},{245,261},{179,274},{199,866},{578,671},{128,720},{26,595},{449,506},{222,911},{62,549},{4,89},{132,372},{202,582},{793,819},{311,378},{153,978},{942,960},{111,716},{909,951},{283,679},{36,581},{310,870},{24,87},{119,518},{360,699},{721,797},{940,961},{233,711},{747,781},{663,817},{311,629},{219,891},{381,826},{489,601},{220,355},{198,938},{51,489},{499,972},{108,863},{180,505},{244,892},{855,940},{210,916},{545,902},{1,95},{229,618},{373,639},{95,908},{310,813},{218,303},{267,860},{312,775},{302,520},{148,695},{132,619},{194,238},{378,782},{103,549},{218,447},{566,752},{740,797},{597,623},{2,44},{259,519},{479,818},{209,391},{449,844},{142,339},{630,989},{231,427},{20,776},{95,142},{214,625},{948,978},{456,787},{555,569},{347,606},{707,757},{543,823},{223,323},{318,460},{145,261},{722,985},{841,861},{25,818},{235,564},{207,867},{575,847},{118,548},{142,939},{63,98},{44,597},{916,937},{240,480},{26,605},{304,360},{97,444},{710,973},{843,988},{88,498},{320,784},{429,986},{62,652},{449,683},{45,475},{728,969},{500,927},{475,712},{75,769},{383,736},{689,902},{317,545},{545,880},{199,814},{533,883},{270,652},{303,764},{549,663},{251,462},{336,432},{56,877},{143,455},{899,965},{11,191},{455,766},{138,975},{343,876},{785,841},{522,598},{131,374},{206,826},{174,197},{324,962},{144,263},{183,234},{117,176},{236,869},{130,830},{34,266},{437,528},{202,494},{727,886},{45,315},{538,572},{113,717},{348,869},{349,966},{158,261},{240,742},{64,556},{108,342},{369,816},{639,880},{325,479},{332,825},{246,654},{212,286},{156,819},{813,885},{551,695},{336,979},{608,884},{74,374},{362,771},{74,802},{448,452},{152,218},{665,737},{752,966},{94,600},{481,694},{325,594},{353,543},{198,710},{282,848},{446,508},{534,810},{270,827},{502,828},{569,950},{355,858},{85,847},{805,906},{616,782},{300,742},{142,381},{135,149},{871,907},{677,808},{25,831},{243,787},{93,263},{121,308},{40,513},{624,687},{260,955},{227,450},{231,846},{376,624},{711,799},{666,952},{437,906},{147,831},{421,594},{167,513},{155,232},{51,81},{761,898},{227,766},{655,917},{543,766},{119,898},{460,965},{153,200},{241,570},{167,216},{338,486},{202,800},{35,970},{419,552},{283,548},{770,953},{192,743},{534,844},{151,685},{184,966},{601,790},{435,911},{295,346},{197,327},{97,661},{216,477},{185,767},{325,513},{33,372},{252,465},{146,333},{238,838},{91,144},{17,747},{401,972},{262,854},{94,598},{124,705},{106,408},{422,503},{261,685},{405,675},{226,983},{73,880},{535,959},{5,972},{98,226},{91,498},{396,429},{803,805},{243,449},{556,620},{42,447},{81,585},{12,88},{361,623},{101,346},{358,806},{469,648},{575,579},{488,567},{489,535},{255,423},{491,662},{241,557},{78,366},{237,685},{89,987},{657,908},{359,871},{184,781},{127,696},{908,934},{597,708},{538,634},{24,409},{100,195},{221,568},{144,837},{203,579},{312,588},{472,690},{508,708},{268,396},{55,771},{311,466},{491,666},{89,300},{12,738},{85,383},{421,435},{47,792},{711,746},{238,978},{472,952},{623,772},{75,416},{542,624},{370,850},{463,498},{259,776},{143,453},{185,766},{129,894},{809,944},{278,397},{312,652},{478,826},{733,798},{711,953},{513,669},{491,921},{594,949},{483,755},{587,919},{396,687},{134,485},{922,998},{903,946},{258,485},{224,782},{745,905},{326,657},{478,655},{44,819},{412,413},{84,398},{525,576},{58,121},{535,587},{13,682},{576,595},{284,672},{437,808},{58,815},{57,755},{245,834},{161,365},{6,447},{126,519},{807,857},{681,765},{309,755},{150,724},{161,428},{812,877},{197,676},{45,874},{856,965},{73,850},{7,73},{550,907},{184,881},{75,962},{516,567},{696,836},{818,995},{242,996},{375,674},{414,971},{430,774},{95,899},{434,567},{777,920},{33,479},{122,207},{339,402},{677,970},{534,903},{53,702},{11,580},{468,979},{45,337},{57,467},{732,960},{720,957},{352,699},{134,589},{454,974},{584,890},{678,724},{76,257},{183,677},{258,620},{478,951},{813,982},{971,980},{19,336},{448,838},{669,993},{182,333},{235,665},{333,475},{779,847},{307,626},{119,293},{19,213},{143,454},{892,950},{471,569},{171,851},{279,394},{294,562},{166,172},{511,539},{299,444},{338,542},{714,907},{231,551},{596,787},{628,631},{289,395},{80,468},{98,869},{371,852},{464,632},{756,988},{69,606},{374,823},{423,920},{46,622},{771,973},{4,682},{174,313},{469,702},{657,776},{27,111},{25,133},{84,989},{91,402},{72,270},{59,924},{7,917},{70,983},{198,547},{381,423},{264,363},{396,924},{264,699},{375,681},{794,842},{124,226},{285,454},{661,973},{723,855},{560,657},{27,106},{308,360},{25,268},{182,194},{462,621},{186,736},{145,246},{52,727},{479,889},{217,381},{128,320},{244,998},{297,406},{39,736},{302,755},{183,757},{523,824},{741,923},{251,453},{222,627},{530,839},{131,825},{565,582},{114,588},{77,554},{656,957},{195,582},{119,698},{312,624},{655,786},{587,970},{616,955},{524,620},{440,803},{612,905},{301,369},{549,719},{329,903},{271,763},{745,884},{95,423},{671,694},{242,364},{6,275},{341,429},{694,716},{168,940},{66,355},{3,36},{537,857},{152,435},{236,741},{196,278},{354,828},{19,593},{159,249},{38,499},{398,729},{209,819},{320,880},{141,144},{63,781},{608,803},{519,630},{638,862},{194,505},{106,734},{107,731},{156,729},{689,998},{137,809},{241,655},{341,605},{120,976},{517,652},{634,909},{356,907},{90,130},{552,892},{191,761},{247,614},{353,488},{267,600},{783,853},{675,872},{167,217},{216,372},{567,607},{460,962},{164,274},{513,882},{466,580},{30,499},{765,798},{261,852},{279,287},{101,584},{253,999},{440,954},{200,619},{621,622},{559,789},{234,474},{391,808},{330,942},{22,658},{85,651},{61,244},{842,860},{383,688},{458,544},{100,470},{172,468},{438,615},{389,939},{68,605},{294,317},{128,731},{658,789},{64,339},{279,455},{725,812},{57,307},{308,560},{384,882},{57,856},{61,726},{306,468},{17,394},{265,704},{231,803},{449,641},{85,143},{215,417},{216,792},{166,658},{96,783},{214,698},{222,804},{90,512},{112,859},{271,421},{328,569},{87,855},{387,568},{243,431},{503,946},{69,368},{77,422},{338,902},{695,870},{150,764},{232,822},{39,276},{599,812},{88,453},{567,923},{274,742},{585,924},{368,711},{407,534},{516,619},{404,446},{193,272},{414,884},{780,918},{868,954},{380,421},{150,535},{167,337},{302,591},{7,161},{140,797},{920,925},{332,379},{225,680},{702,976},{201,501},{849,873},{395,545},{303,504},{91,820},{194,272},{861,868},{4,526},{220,462},{446,636},{277,788},{574,849},{428,880},{585,618},{291,583},{658,777},{931,933},{167,905},{349,513},{21,141},{245,989},{852,862},{111,553},{469,797},{209,421},{407,976},{48,782},{332,466},{326,837},{634,832},{124,915},{98,974},{302,678},{320,718},{748,839},{294,910},{275,373},{621,660},{401,952},{499,683},{365,667},{668,991},{235,647},{35,373},{527,698},{776,996},{16,331},{36,491},{135,145},{207,710},{429,828},{136,756},{110,674},{169,932},{737,813},{512,853},{297,463},{739,768},{625,813},{832,935},{362,792},{667,686},{7,996},{530,655},{56,536},{640,927},{780,818},{387,695},{482,597},{327,824},{188,847},{318,519},{787,801},{568,741},{239,964},{139,532},{449,748},{20,559},{66,262},{446,604},{97,901},{740,752},{374,812},{29,886},{469,633},{250,923},{218,551},{178,246},{126,849},{667,756},{168,697},{86,565},{466,969},{444,623},{610,638},{146,628},{444,761},{56,966},{208,610},{219,526},{85,463},{217,288},{126,219},{236,829},{236,890},{164,520},{191,766},{387,542},{261,295},{158,870},{334,794},{305,689},{3,330},{75,604},{404,957},{452,690},{306,923},{149,893},{137,689},{159,639},{671,710},{78,688},{696,834},{90,736},{613,740},{231,819},{404,565},{0,894},{511,912},{131,179},{197,485},{828,997},{113,291},{119,780},{87,679},{306,743}};

for(int i=0;i<(sizeof(edges)/sizeof(edges[0]));i++){
            G.add_edge(edges[i][0],edges[i][1]);
          //  G.add_edge(edges[i][1],edges[i][0]);
    }
     int* membership;
    int  num_membership;

    membership = new int[G.num_nodes()];
    num_membership = 0;

    num_membership = kosaraju(G, membership);
    printf("num_membership = %d\n", num_membership);
#endif
}

